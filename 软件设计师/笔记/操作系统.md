# 计算机系统层次结构图

- 应用软件：最终用户
- 系统软件：应用软件开发人员
- 操作系统：应用软件开发人员，系统软件开发人员
- 计算机硬件：系统软件开发人员

## 前趋图

有向无循环图

顺序执行主要特征：顺序性，封闭性，可在现性

P(S): S = S - 1

V(S): S = S + 1

### 解题

1. 几个箭头就有几个信号量S，标记 S1 到 Sn，按照两边组合的大小排序，放在箭头上
2. 前趋图上**箭头出是V，箭头进是P**

## 并发执行特征：

1. 失去程序的封闭性
2. 程序与机器的执行程序的活动不再一一对应
3. 并发程序间的相互制约性

### 三态模型：

- 运行：有CPU，有资源
- 就绪：无CPU，有资源
- 阻塞：无CPU，无资源

## 进程间的通信

### 互斥

- 资源共享，临界资源间的间接制约

### 同步

- 相互合作，直接制约

### 临界区管理原则

1. 有空即进
2. 无空则等
3. 有限等待
4. 让权等待

## 信号量机制

P：申请资源，S-1

V：释放资源，S+1

S：资源数量，负数的绝对值为等待资源的进程，正数为可用资源数量，范围是 -(n-资源数) ~ 资源数

利用PV操作可实现资源互斥使用

互斥操作：PV成对出现，信号量为1

同步操作：PV交叉出现，信号量为缓存区大小

生产者与消费者

S1：仓库货物数量

S2：购物车货物数量

## 死锁

同类资源分配不当

m：资源

n：进程

k：进程最大需求

m < n * k，可能引起死锁

资源分配策略为逐个进程依次分配，然后重复

**系统内有n个进程，每个进程都需要R个资源，那么其发生死锁的最大资源数为n\*(R-1) 。 其不发生死锁的最小资源数为n*(R-1)+1**

死锁处理

鸵鸟策略：没有策略，不管

资源：最大，已分配，仍需，可用

## 进程资源图

先分配，再申请

进程无法获取所需资源，则阻塞

死锁：所有进程都阻塞

判断是否阻塞时，只是看申请时是否可以申请到资源，不会减少空闲资源，所以可以两个进程对同一个资源进行申请。

## 线程

同属一个进程的线程可以共享这个进程的所有资源，但线程之间是不可见的

## 程序局部性原理

### 时间局限性：

- 指令执行过，将来可能再次被执行
- 存储单元访问过，将来可能再次被访问

原因：程序中存在大量循环操作

### 空间局限性：

- 存储单元访问过，将来附近的存储单元也最有可能被访问，即一段时间内访问的地址集中在一起

原因：程序顺序执行

### 淘汰表：

- 状态位，访问位，修改位逐个判断是否为0（即不在内存，未访问过，未修改过），若为0，则淘汰
- 0越多，则代价越小
- 不在内存中，不用淘汰

## 分页存储管理

### 地址结构：

1. 16位，0-15

   - 0-11：页内地址
   - 12-15：页号

2. 页面大小：页内地址大小（物理页大小），0-11，共12位，如页内大小为4K，4K=4096=2^12

3. 逻辑地址：可分为页号和页内地址

4. 题目技巧：

   1. 16进制逻辑地址的后三位为2进制的12位，正好满足页内地址
   2. 16进制逻辑地址的从左到右的第一位转换为10进制
   3. 在页面转换表中找到相同的页号对应的物理块号
   4. 物理块号和16进制逻辑地址的后三位组合，为物理地址

   **即根据16进制逻辑地址的从左到右的第一位找到页号，用页号对应的物理块号与后三位直接组合**

### 段页储存管理

| 段号 | 页号 | 页内地址 |

最多有多少段：2^（大段号-小段号+1）

每个段最大允许有多少页：2^（大页号-小页号+1）

页的大小：2^（大页内地址-小页内地址+1）

### 单缓冲区

T：输入

M：输出

C：处理

n：作业个数

C < T：(T+M) * n + C

### 双缓冲区

M + C < T：T * n + M + C

## 磁盘（移臂）调度算法

### 先来先服务(FCFS)

- 按照请求顺序连接并计算差值，平均寻道长度 = 差值求和 / 差值个数

### 最短寻道时间优先(SSTF)

- 在请求顺序上，谁近谁先

### 扫描算法(SCAN)或电梯调度算法

- 一个方向走到头，再换方向，选择离开始最近的反方向的点

### 循环扫描算法(CSCAN)或单向扫描算法

- 一个方向走到头，再换方向，选择离开始最远的反方向的点，再转方向

注：只用看柱面号和请求序列，离初始柱面最近的为第一个

## 旋转调度算法

只能向前走

扇区1：读取时间+处理时间

扇区2~n：(读取一圈+读取时间+处理时间) * (n - 1)

优化：

- 处理完后正好停在下一个的开始
- 时间：(读取时间 + 处理时间) * 个数

## 多级索引结构

一个地址项：4B

一个磁盘索引块：1KB

一个磁盘数据块：1KB

直接地址索引（第0，1，2块）：索引表的地址项直接指向磁盘数据块

一级间接地址索引（第3块）：索引表的地址项指向一级地址索引块，一级地址索引块的地址项再分别指向磁盘数据块

二级间接地址索引（第4块）：索引表的地址项指向二级地址索引块，二级地址索引块的地址项分别指向一级地址索引块，一级地址索引块的地址项再分别指向磁盘数据块

## 文件目录

### 文件控制块（FCD）

1. 基本信息类
2. 存取控制信息类
3. 使用信息类

修改**目录文件**时崩溃，对系统的影响较大

## 目录结构

### 多级目录结构

- 全文件名：从根目录一直到文件名
- 绝对路径：从根目录一直到文件所在文件夹
- 相对路径：当前文件夹及文件

## 位示图

用二进制的一位来表示一个物理块的使用情况

0：空闲

1：占用

## 附加

1. **文件级**安全管理：控制用户对文件的访问
2. **win**支持**FAT，FAT32，NTFS**文件系统
3. UNIX系统中，地址0~9为直接索引，地址10为一级间接索引（256个地址块），地址11为二级间接索引，地址13为三级间接索引
4. 嵌入式系统特点：微型化，可定制性，实时性，可靠性，易移植性
5. Linux修改文件权限：**chmod**
6. 实时系统对于来自外部的事件必须在**被控对象规定的时间内做出及时响应并对其进行处理**
7. 嵌入式系统初始化过程（自底向上）：片级初始化→板级初始化→系统级初始化
8. 系统初始化主要任务：以软件初始化为主，主要进行操作系统的初始化
9. **磁盘清理**和**碎片整理**不会清除有用数据
10. Windows系统通过建立的**文件关联**来决定使用什么程序打开该文件